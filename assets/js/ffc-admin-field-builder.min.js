!function(e,t){"use strict";var l=0;var f,a=[{value:"text",label:(f="undefined"!=typeof ffc_ajax&&ffc_ajax.strings?ffc_ajax.strings:{}).textField||"Text Field"},{value:"email",label:f.email||"Email"},{value:"number",label:f.number||"Number"},{value:"textarea",label:f.textarea||"Textarea"},{value:"select",label:f.dropdownSelect||"Dropdown Select"},{value:"checkbox",label:f.checkbox||"Checkbox"},{value:"radio",label:f.radioButtons||"Radio Buttons"},{value:"date",label:f.date||"Date"},{value:"info",label:f.infoBlock||"Info Block"},{value:"embed",label:f.embedMedia||"Embed (Media)"}];function i(t){l++;var f="undefined"!=typeof ffc_ajax&&ffc_ajax.strings?ffc_ajax.strings:{},i=f.remove||"Remove",d=f.fieldType||"Field Type:",o=f.label||"Label:",c=f.fieldLabel||"Field Label",s=f.nameVariable||"Name (variable):",r=f.fieldName||"field_name",p=f.required||"Required:",u=f.options||"Options:",b=f.separateWithCommas||"Separate with commas",h=f.content||"Content:",m=f.contentPlaceholder||"Text to display. Supports <b>, <i>, <a>.",v=f.titleOptional||"Title (optional):",x=f.embedUrl||"Media URL:",g=f.embedUrlPlaceholder||"https://www.youtube.com/watch?v=... or image URL",y=f.captionOptional||"Caption (optional):",w="info"===t,_="embed"===t,F=w||_,j='<div class="ffc-field-row" data-index="'+l+'">';if(j+='  <div class="ffc-field-row-header">',j+='    <span class="ffc-sort-handle">',j+='      <span class="dashicons dashicons-menu"></span>',j+='      <span class="ffc-field-title"><strong>'+t.toUpperCase()+"</strong></span>",j+="    </span>",j+='    <button type="button" class="button button-link-delete ffc-remove-field">'+i+"</button>",j+="  </div>",j+='  <div class="ffc-field-row-body">',j+='    <table class="form-table">',j+="      <tr>",j+="        <th><label>"+d+"</label></th>",j+='        <td><select class="ffc-field-type" name="ffc_fields['+l+'][type]">',a.forEach(function(e){var l=e.value===t?" selected":"";j+='<option value="'+e.value+'"'+l+">"+e.label+"</option>"}),j+="        </select></td>",j+="      </tr>",j+='      <tr class="ffc-content-row"'+(w?"":' style="display:none"')+">",j+="        <th><label>"+h+"</label></th>",j+='        <td><textarea class="ffc-field-content large-text" name="ffc_fields['+l+'][content]" rows="4" placeholder="'+m+'"></textarea></td>',j+="      </tr>",j+='      <tr class="ffc-embed-row"'+(_?"":' style="display:none"')+">",j+="        <th><label>"+x+"</label></th>",j+='        <td><input type="url" class="ffc-field-embed-url regular-text" name="ffc_fields['+l+'][embed_url]" placeholder="'+g+'"></td>',j+="      </tr>",j+="      <tr>",j+="        <th><label>"+(w?v:_?y:o)+"</label></th>",j+='        <td><input type="text" class="ffc-field-label regular-text" name="ffc_fields['+l+'][label]" placeholder="'+c+'"></td>',j+="      </tr>",j+='      <tr class="ffc-standard-row"'+(F?' style="display:none"':"")+">",j+="        <th><label>"+s+"</label></th>",j+='        <td><input type="text" class="ffc-field-name regular-text" name="ffc_fields['+l+'][name]" placeholder="'+r+'"></td>',j+="      </tr>",j+='      <tr class="ffc-standard-row"'+(F?' style="display:none"':"")+">",j+="        <th><label>"+p+"</label></th>",j+='        <td><input type="checkbox" class="ffc-field-required" name="ffc_fields['+l+'][required]" value="1"></td>',j+="      </tr>","select"===t||"radio"===t||"checkbox"===t){j+="      <tr>",j+="        <th><label>"+u+"</label></th>",j+='        <td><textarea class="ffc-field-options large-text" name="ffc_fields['+l+'][options]" rows="3" placeholder="'+b+'"></textarea>';var k=f.quizPoints||"Points per option:",C=f.quizPointsPlaceholder||"Ex: 0, 10, 0",q="undefined"!=typeof jQuery&&jQuery("#ffc_quiz_enabled").is(":checked");j+='          <div class="ffc-quiz-points'+(q?"":" ffc-hidden")+'" style="margin-top:8px">',j+='            <label style="font-weight:500;font-size:13px">'+k+"</label>",j+='            <input type="text" class="ffc-field-points regular-text" name="ffc_fields['+l+'][points]" placeholder="'+C+'" style="width:100%;margin-top:4px">',j+="          </div>",j+="        </td>",j+="      </tr>"}j+="    </table>",j+="  </div>",j+="</div>",e("#ffc-fields-container").append(j),n()}function n(){var t=[];e("#ffc-fields-container .ffc-field-row").each(function(){var l=e(this),f={type:l.find(".ffc-field-type").val(),label:l.find(".ffc-field-label").val(),name:l.find(".ffc-field-name").val(),required:l.find(".ffc-field-required").is(":checked"),options:l.find(".ffc-field-options").val(),content:l.find(".ffc-field-content").val()||"",embed_url:l.find(".ffc-field-embed-url").val()||"",points:l.find(".ffc-field-points").val()||""};t.push(f)});var l=e("#ffc-form-fields-json");l.length||(l=e('input[name="ffc_form_fields"], textarea[name="ffc_form_fields"]')),l.length?l.val(JSON.stringify(t)):console.warn("[FFC] JSON field not found")}window.FFC=window.FFC||{},window.FFC.Admin=window.FFC.Admin||{},window.FFC.Admin.FieldBuilder={init:function(){0!==e("#ffc-fields-container").length&&(l=e("#ffc-fields-container .ffc-field-row").length,e(document).on("click",".ffc-add-field",function(t){t.preventDefault(),function(t){e(".ffc-field-type-menu").remove();var l=e('<div class="ffc-field-type-menu"></div>'),f="undefined"!=typeof ffc_ajax&&ffc_ajax.strings&&ffc_ajax.strings.chooseFieldType?ffc_ajax.strings.chooseFieldType:"Choose Field Type:";l.append('<div class="ffc-menu-header">'+f+"</div>");var n=e("<ul></ul>");a.forEach(function(t){var f=e('<li data-type="'+t.value+'">'+t.label+"</li>");f.on("click",function(){i(t.value),l.remove()}),n.append(f)}),l.append(n);var d=t.offset(),o=t.outerHeight();l.css({position:"absolute",top:d.top+o+5+"px",left:d.left+"px",zIndex:99999,background:"#fff",border:"1px solid #ccc",borderRadius:"4px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",minWidth:"200px"}),e("body").append(l),setTimeout(function(){e(document).one("click",function(){l.remove()})},100)}(e(this))}),e(document).on("click",".ffc-remove-field",function(t){t.preventDefault();var l="undefined"!=typeof ffc_ajax&&ffc_ajax.strings&&ffc_ajax.strings.confirmDeleteField?ffc_ajax.strings.confirmDeleteField:"Remove this field?";confirm(l)&&e(this).closest(".ffc-field-row").fadeOut(300,function(){e(this).remove(),n()})}),e("#ffc-fields-container").on("change input","input, select, textarea",function(){n()}),e("#ffc-fields-container").on("change",".ffc-field-type",function(){var t=e(this).closest(".ffc-field-row"),l=e(this).val(),f="info"===l,a="embed"===l,i=f||a;t.find(".ffc-content-row").toggle(f),t.find(".ffc-embed-row").toggle(a),t.find(".ffc-standard-row").toggle(!i),t.find(".ffc-options-field").toggle("select"===l||"radio"===l||"checkbox"===l)}),e("#ffc-fields-container").on("change",".ffc-field-type-selector",function(){var t=e(this).closest(".ffc-field-row"),l=e(this).val(),f="info"===l,a="embed"===l,i=f||a;t.find(".ffc-content-field").toggleClass("ffc-hidden",!f),t.find(".ffc-embed-field").toggleClass("ffc-hidden",!a),t.find(".ffc-standard-row").toggleClass("ffc-hidden",i),t.find(".ffc-options-field").toggleClass("ffc-hidden",!("select"===l||"radio"===l||"checkbox"===l))}),e.fn.sortable&&e("#ffc-fields-container").sortable({handle:".ffc-sort-handle",placeholder:"ffc-field-placeholder",update:function(){n()}}))},addField:i,updateJSON:n},t.registerModule&&t.registerModule("Admin.FieldBuilder",t.version)}(jQuery,window.FFC);